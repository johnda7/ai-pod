import{r as k,j as e,A as C,m as o,d as j,X as P,h as W,F as I,n as O,T as B,k as R}from"./index-DVky-oRy.js";import{u as q}from"./useSyncTool-DUW8--Ui.js";import{S as K}from"./SyncIndicator-BfQIsYUy.js";const M=[{name:"ÐœÐµÐ´Ð¸Ñ‚Ð°Ñ†Ð¸Ñ",emoji:"ðŸ§˜",color:"#8b5cf6",image:"https://images.unsplash.com/photo-1506126613408-eca07ce68773?w=200&h=200&fit=crop"},{name:"Ð¡Ð¿Ð¾Ñ€Ñ‚",emoji:"ðŸ’ª",color:"#22c55e",image:"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=200&h=200&fit=crop"},{name:"Ð§Ñ‚ÐµÐ½Ð¸Ðµ",emoji:"ðŸ“š",color:"#3b82f6",image:"https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?w=200&h=200&fit=crop"},{name:"Ð’Ð¾Ð´Ð°",emoji:"ðŸ’§",color:"#06b6d4",image:"https://images.unsplash.com/photo-1548839140-29a749e1cf4d?w=200&h=200&fit=crop"},{name:"Ð¡Ð¾Ð½ 8Ñ‡",emoji:"ðŸ˜´",color:"#6366f1",image:"https://images.unsplash.com/photo-1520206183501-b80df61043c2?w=200&h=200&fit=crop"},{name:"Ð‘ÐµÐ· ÑÐ¾Ñ†ÑÐµÑ‚ÐµÐ¹",emoji:"ðŸ“µ",color:"#ef4444",image:"https://images.unsplash.com/photo-1512428559087-560fa5ceab42?w=200&h=200&fit=crop"},{name:"Ð£Ñ‡Ñ‘Ð±Ð°",emoji:"ðŸ“–",color:"#f59e0b",image:"https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=200&h=200&fit=crop"},{name:"ÐŸÑ€Ð¾Ð³ÑƒÐ»ÐºÐ°",emoji:"ðŸš¶",color:"#10b981",image:"https://images.unsplash.com/photo-1476480862126-209bfaa8edc8?w=200&h=200&fit=crop"}],X=["ÐŸÐ½","Ð’Ñ‚","Ð¡Ñ€","Ð§Ñ‚","ÐŸÑ‚","Ð¡Ð±","Ð’Ñ"],Y=(c,g,x,s)=>{if(s===0)return{text:"Ð¡Ð¾Ð·Ð´Ð°Ð¹ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÑƒ! ðŸŒ±",color:"#22c55e"};const d=g-c+1;return x===s&&s>0?{text:"ðŸ”¥ Ð’ÑÐµ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹! Ð¢Ñ‹ Ð¾Ð³Ð¾Ð½ÑŒ!",color:"#f59e0b"}:c>0&&c===g?{text:"ðŸ† Ð¢Ñ‹ Ð½Ð° ÑÐ²Ð¾Ñ‘Ð¼ Ñ€ÐµÐºÐ¾Ñ€Ð´Ðµ! ÐÐµ Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ð¹ÑÑ!",color:"#eab308"}:c>0&&d<=3&&d>0?{text:`â­ Ð•Ñ‰Ñ‘ ${d} ${d===1?"Ð´ÐµÐ½ÑŒ":"Ð´Ð½Ñ"} Ð´Ð¾ Ñ€ÐµÐºÐ¾Ñ€Ð´Ð°!`,color:"#a855f7"}:c>=7?{text:"ðŸ’Ž ÐÐµÐ´ÐµÐ»Ñ Ð¿Ð¾Ð´Ñ€ÑÐ´! Ð¢Ñ‹ Ð»ÐµÐ³ÐµÐ½Ð´Ð°!",color:"#6366f1"}:c>=3?{text:"ðŸš€ ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ! Ð”ÐµÑ€Ð¶Ð¸ Ñ‚ÐµÐ¼Ð¿!",color:"#22c55e"}:x>0?{text:"âœ¨ Ð¥Ð¾Ñ€Ð¾ÑˆÐµÐµ Ð½Ð°Ñ‡Ð°Ð»Ð¾! ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð°Ð¹!",color:"#3b82f6"}:{text:"ðŸ‘‹ Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÑƒ ÑÐµÐ³Ð¾Ð´Ð½Ñ!",color:"#64748b"}},V=({isOpen:c,onClose:g,onComplete:x})=>{const{data:s,setData:d,syncStatus:F}=q([],{storageKey:"habit_tracker_data",debounceMs:1e3}),[y,w]=k.useState(!1),[u,N]=k.useState(""),[i,S]=k.useState(null),m=new Date().toISOString().split("T")[0],H=()=>{if(!u.trim()&&!i)return;const t=i||M[0],a={id:Date.now().toString(),name:u.trim()||t.name,emoji:t.emoji,color:t.color,image:t.image,streak:0,completedDays:[],createdAt:Date.now(),goal:7};d([...s,a]),N(""),S(null),w(!1),x(10)},A=t=>{d(s.map(a=>{if(a.id!==t)return a;const l=a.completedDays.includes(m);let r,n=a.streak;if(l)r=a.completedDays.filter(h=>h!==m),n=Math.max(0,n-1);else{r=[...a.completedDays,m];const h=new Date;h.setDate(h.getDate()-1);const E=h.toISOString().split("T")[0];(a.completedDays.includes(E)||a.streak===0)&&(n=a.streak+1),x(5)}return{...a,completedDays:r,streak:n}}))},_=t=>{d(s.filter(a=>a.id!==t))},D=(()=>{const t=[];for(let a=6;a>=0;a--){const l=new Date;l.setDate(l.getDate()-a),t.push({date:l.toISOString().split("T")[0],label:X[l.getDay()===0?6:l.getDay()-1],isToday:a===0})}return t})(),v=s.filter(t=>t.completedDays.includes(m)).length,p=s.reduce((t,a)=>t+a.streak,0),T="habit_tracker_best_streak",z=parseInt(localStorage.getItem(T)||"0",10),$=Math.max(z,p);p>z&&localStorage.setItem(T,p.toString());const b=Y(p,$,v,s.length),f=(()=>{if(s.length===0)return{completed:0,total:0,percentage:0};let t=0;const a=s.length*7;return D.forEach(l=>{s.forEach(r=>{r.completedDays.includes(l.date)&&t++})}),{completed:t,total:a,percentage:Math.round(t/a*100)}})();return c?e.jsx(C,{children:e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(180deg, #0a1a0f 0%, #0f2518 30%, #0a0a1a 100%)"}}),e.jsx(o.div,{className:"absolute top-0 left-0 w-full h-1/2",style:{background:"radial-gradient(ellipse at 30% 0%, rgba(34,197,94,0.2) 0%, transparent 60%)",filter:"blur(60px)"},animate:{opacity:[.3,.6,.3]},transition:{duration:4,repeat:1/0}}),e.jsx(o.div,{className:"absolute top-20 right-0 w-1/2 h-1/2",style:{background:"radial-gradient(ellipse at 100% 20%, rgba(16,185,129,0.15) 0%, transparent 60%)",filter:"blur(50px)"},animate:{opacity:[.4,.7,.4]},transition:{duration:5,repeat:1/0,delay:1}}),[...Array(15)].map((t,a)=>e.jsx(o.div,{className:"absolute w-1 h-1 bg-white rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,opacity:.3+Math.random()*.4},animate:{opacity:[.2,.8,.2]},transition:{duration:2+Math.random()*3,repeat:1/0,delay:Math.random()*2}},a))]}),e.jsx("div",{className:"sticky top-0 z-30 px-4 pt-4 pb-4",children:e.jsxs(o.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"p-4 rounded-3xl",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(40px)",border:"1px solid rgba(255,255,255,0.15)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-14 h-14 rounded-xl overflow-hidden relative",style:{boxShadow:"0 4px 20px rgba(34,197,94,0.3)"},children:[e.jsx("img",{src:"https://images.unsplash.com/photo-1484480974693-6ca0a78fb36b?w=100&h=100&fit=crop",alt:"Habits",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-green-600/60 to-transparent"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(j,{size:24,className:"text-white"})})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"ÐŸÑ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-white/50 text-xs",children:[v,"/",s.length," ÑÐµÐ³Ð¾Ð´Ð½Ñ"]}),e.jsx(K,{status:F})]})]})]}),e.jsx("button",{onClick:g,className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.1)"},children:e.jsx(P,{size:20,className:"text-white"})})]}),e.jsxs("div",{className:"mb-4 p-3 rounded-2xl",style:{background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.08)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{size:14,className:"text-green-400"}),e.jsx("span",{className:"text-white/70 text-xs font-medium",children:"ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ Ð½ÐµÐ´ÐµÐ»Ð¸"})]}),e.jsxs("span",{className:"text-green-400 font-bold text-sm",children:[f.percentage,"%"]})]}),e.jsx("div",{className:"h-3 rounded-full overflow-hidden",style:{background:"rgba(255,255,255,0.08)"},children:e.jsx(o.div,{className:"h-full rounded-full",initial:{width:0},animate:{width:`${f.percentage}%`},transition:{duration:.8,ease:"easeOut"},style:{background:"linear-gradient(90deg, #22c55e 0%, #16a34a 50%, #15803d 100%)",boxShadow:"0 0 15px rgba(34,197,94,0.5)"}})}),e.jsxs("div",{className:"flex justify-between mt-1.5",children:[e.jsxs("span",{className:"text-white/30 text-[10px]",children:[f.completed," Ð¸Ð· ",f.total," Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾"]}),e.jsx("span",{className:"text-white/30 text-[10px]",children:"Ð¦ÐµÐ»ÑŒ: 100%"})]})]}),e.jsx("div",{className:"mb-3 p-3 rounded-xl text-center",style:{background:`${b.color}15`,border:`1px solid ${b.color}30`},children:e.jsx("span",{className:"text-sm font-medium",style:{color:b.color},children:b.text})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 p-3 rounded-xl text-center",style:{background:"rgba(34,197,94,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(34,197,94,0.2)"},children:[e.jsxs("div",{className:"text-xl font-bold text-green-400 flex items-center justify-center gap-1",children:[v,e.jsx(j,{size:14})]}),e.jsx("div",{className:"text-white/40 text-[10px]",children:"Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ"})]}),e.jsxs("div",{className:"flex-1 p-3 rounded-xl text-center",style:{background:"rgba(249,115,22,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(249,115,22,0.2)"},children:[e.jsxs("div",{className:"text-xl font-bold text-orange-400 flex items-center justify-center gap-1",children:[p,e.jsx(I,{size:14})]}),e.jsx("div",{className:"text-white/40 text-[10px]",children:"Streak"})]}),e.jsxs("div",{className:"flex-1 p-3 rounded-xl text-center",style:{background:"rgba(234,179,8,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(234,179,8,0.2)"},children:[e.jsxs("div",{className:"text-xl font-bold text-yellow-400 flex items-center justify-center gap-1",children:[$,e.jsx(O,{size:14})]}),e.jsx("div",{className:"text-white/40 text-[10px]",children:"Ð ÐµÐºÐ¾Ñ€Ð´"})]})]})]})}),e.jsx("div",{className:"relative z-10 px-4 pb-40 overflow-y-auto h-[calc(100vh-240px)]",children:s.length===0&&!y?e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"rounded-3xl p-6 text-center",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl overflow-hidden",children:e.jsx("img",{src:"https://images.unsplash.com/photo-1484480974693-6ca0a78fb36b?w=200&h=200&fit=crop",alt:"Start",className:"w-full h-full object-cover"})}),e.jsx("h3",{className:"text-white font-bold text-lg mb-2",children:"Ð¡Ð¾Ð·Ð´Ð°Ð¹ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÑƒ!"}),e.jsx("p",{className:"text-white/40 text-sm",children:"21 Ð´ÐµÐ½ÑŒ â€” Ð¸ Ð¾Ð½Ð° ÑÑ‚Ð°Ð½ÐµÑ‚ Ñ‡Ð°ÑÑ‚ÑŒÑŽ Ñ‚ÐµÐ±Ñ"})]}):e.jsx("div",{className:"space-y-4",children:s.map((t,a)=>{const l=t.completedDays.includes(m);return e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:a*.05},className:"rounded-2xl overflow-hidden",style:{background:l?`linear-gradient(135deg, ${t.color}20 0%, ${t.color}10 100%)`:"linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%)",border:`1px solid ${l?t.color+"40":"rgba(255,255,255,0.1)"}`},children:[e.jsxs("div",{className:"flex items-center gap-3 p-4",children:[e.jsxs("button",{onClick:()=>A(t.id),className:"w-14 h-14 rounded-xl overflow-hidden relative shrink-0",style:{boxShadow:l?`0 4px 15px ${t.color}40`:"none"},children:[e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center transition-all",style:{background:l?t.color:"rgba(0,0,0,0.5)"},children:l?e.jsx(j,{size:24,className:"text-white",strokeWidth:3}):e.jsx("span",{className:"text-2xl",children:t.emoji})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-bold",children:t.name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:t.streak>0&&e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-md flex items-center gap-1",style:{background:"rgba(249,115,22,0.2)",color:"#fb923c"},children:[e.jsx(I,{size:10})," ",t.streak," Ð´Ð½ÐµÐ¹"]})})]}),e.jsx("button",{onClick:()=>_(t.id),className:"w-8 h-8 rounded-lg flex items-center justify-center bg-white/5 hover:bg-red-500/20 transition-colors",children:e.jsx(B,{size:14,className:"text-white/40 hover:text-red-400"})})]}),e.jsx("div",{className:"flex gap-1.5 px-4 pb-4",children:D.map(r=>{const n=t.completedDays.includes(r.date);return e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"w-full aspect-square rounded-lg flex items-center justify-center mb-1 transition-all",style:{background:n?t.color:r.isToday?"rgba(255,255,255,0.1)":"rgba(255,255,255,0.03)",border:r.isToday&&!n?"1px dashed rgba(255,255,255,0.3)":"none",boxShadow:n?`0 2px 8px ${t.color}50`:"none"},children:n&&e.jsx(j,{size:12,className:"text-white"})}),e.jsx("span",{className:`text-[9px] ${r.isToday?"text-white font-bold":"text-white/30"}`,children:r.label})]},r.date)})})]},t.id)})})}),e.jsx(C,{children:y&&e.jsx(o.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"fixed inset-x-0 bottom-0 z-50 p-4 pb-8",style:{background:"linear-gradient(to top, #0a0a1a 0%, #0a0a1a 80%, transparent 100%)"},children:e.jsxs("div",{className:"rounded-3xl p-4",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(40px)",border:"1px solid rgba(255,255,255,0.15)"},children:[e.jsx("h3",{className:"text-white font-bold mb-3",children:"ÐÐ¾Ð²Ð°Ñ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ°"}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-4",children:M.map(t=>e.jsxs("button",{onClick:()=>{S(t),N(t.name)},className:"aspect-square rounded-xl overflow-hidden relative transition-all",style:{border:(i==null?void 0:i.name)===t.name?`2px solid ${t.color}`:"2px solid transparent",boxShadow:(i==null?void 0:i.name)===t.name?`0 4px 15px ${t.color}40`:"none"},children:[e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:`${t.color}60`},children:e.jsx("span",{className:"text-2xl",children:t.emoji})})]},t.name))}),e.jsx("input",{type:"text",value:u,onChange:t=>N(t.target.value),placeholder:"Ð˜Ð»Ð¸ Ð²Ð²ÐµÐ´Ð¸ ÑÐ²Ð¾Ñ‘ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ...",className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-white/30 mb-4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>w(!1),className:"flex-1 py-3 rounded-xl font-medium",style:{background:"rgba(255,255,255,0.05)",color:"rgba(255,255,255,0.5)"},children:"ÐžÑ‚Ð¼ÐµÐ½Ð°"}),e.jsx("button",{onClick:H,disabled:!u.trim()&&!i,className:"flex-1 py-3 rounded-xl font-medium text-white disabled:opacity-50",style:{background:"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)",boxShadow:"0 4px 15px rgba(34,197,94,0.4)"},children:"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ"})]})]})})}),!y&&e.jsx("div",{className:"fixed bottom-24 left-4 right-4 z-40",children:e.jsxs(o.button,{onClick:()=>w(!0),className:"w-full py-4 rounded-2xl font-bold text-white flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)",boxShadow:"0 8px 32px rgba(34,197,94,0.4)"},whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(R,{size:20}),"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÑƒ"]})})]})}):null};export{V as HabitTracker,V as default};
